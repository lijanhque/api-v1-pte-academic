import { StreamSubscription } from './stream-subscription';
export class StreamItemSubscription extends StreamSubscription {
    constructor(sub) {
        super(sub, null);
        this.lastEventTimestamp = 0;
    }
    listener(message) {
        if (message.timestamp <= this.lastEventTimestamp) {
            return;
        }
        this.lastEventTimestamp = message.timestamp;
        if (message.event.type === 'sync' || message.event.type === 'create' || message.event.type === 'update') {
            this.setState(message.event.data);
        }
        else if (message.event.type === 'delete') {
            this.setState(null);
        }
        else if (message.event.type === 'event') {
            this.onEventReceived(message.event.event);
        }
    }
}
