"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.generateTypeFromSchema = void 0;
const schema_types_1 = require("./schema.types");
const generateTypeFromSchema = (schema) => {
    if (!schema) {
        return 'unknown';
    }
    if ((0, schema_types_1.isAnyOf)(schema)) {
        const types = schema.anyOf.map(exports.generateTypeFromSchema);
        return types.join(' | ');
    }
    if (schema.type === 'array') {
        const itemType = schema.items ? (0, exports.generateTypeFromSchema)(schema.items) : 'unknown';
        return `Array<${itemType}>`;
    }
    if (schema.type === 'object' && schema.properties) {
        const props = Object.entries(schema.properties).map(([key, prop]) => {
            const isRequired = schema.required?.includes(key);
            const propType = (0, exports.generateTypeFromSchema)(prop);
            return `${key}${isRequired ? '' : '?'}: ${propType}`;
        });
        return props.length > 0 ? `{ ${props.join('; ')} }` : '{}';
    }
    else if (schema.type === 'object' && schema.additionalProperties) {
        const propType = (0, exports.generateTypeFromSchema)(schema.additionalProperties);
        return `Record<string, ${propType}>`;
    }
    if (schema.type === 'string') {
        if (schema.format === 'binary') {
            return 'Buffer';
        }
        return schema.enum && schema.enum.length > 0 // must have at least one enum value
            ? schema.enum.map((value) => `'${value}'`).join(' | ')
            : 'string';
    }
    if (typeof schema === 'object' && schema !== null && 'not' in schema) {
        return 'undefined';
    }
    switch (schema.type) {
        case 'number':
            return 'number';
        case 'boolean':
            return 'boolean';
        default:
            return 'unknown';
    }
};
exports.generateTypeFromSchema = generateTypeFromSchema;
