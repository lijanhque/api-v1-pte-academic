"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.FlowsStream = void 0;
const stream_adapter_interface_1 = require("../adapters/interfaces/stream-adapter.interface");
const flows_helper_1 = require("../helper/flows-helper");
const motia_1 = require("../motia");
class FlowsStream extends stream_adapter_interface_1.StreamAdapter {
    constructor(lockedData) {
        super('__motia.flows');
        this.lockedData = lockedData;
    }
    async get(_, id) {
        const flow = this.lockedData.flows[id];
        if (!flow) {
            return null;
        }
        return (0, flows_helper_1.generateFlow)(id, flow.steps);
    }
    async delete(_) {
        return null;
    }
    async set(_, __, data) {
        return data;
    }
    async getGroup() {
        /**
         * Get list should receive a groupId argument but that's irrelevant for this stream
         * since we only have one group of flows.
         */
        return Object.entries(this.lockedData.flows)
            .map(([id, flow]) => (0, flows_helper_1.generateFlow)(id, flow.steps))
            .filter((flow) => flow.id !== motia_1.PLUGIN_FLOW_ID);
    }
}
exports.FlowsStream = FlowsStream;
