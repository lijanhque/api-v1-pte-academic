"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.BaseLoggerFactory = void 0;
const crypto_1 = require("crypto");
const logger_1 = require("./logger");
class BaseLoggerFactory {
    constructor(isVerbose, logStream) {
        this.isVerbose = isVerbose;
        this.logStream = logStream;
    }
    create({ stepName, traceId, flows }) {
        const streamListener = (level, msg, args) => {
            const id = (0, crypto_1.randomUUID)();
            this.logStream.set('default', id, {
                id,
                ...(args ?? {}),
                level,
                time: Date.now(),
                msg,
                traceId,
                flows: flows ?? [],
            });
        };
        return new logger_1.Logger(this.isVerbose, { traceId, flows, step: stepName }, [streamListener]);
    }
}
exports.BaseLoggerFactory = BaseLoggerFactory;
