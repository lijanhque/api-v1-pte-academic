import fs from 'fs';
import { globSync } from 'glob';
import path from 'path';
export const includeStaticFiles = (steps, builder, archive) => {
    for (const step of steps) {
        if ('includeFiles' in step.config) {
            const staticFiles = step.config.includeFiles;
            if (!staticFiles || !Array.isArray(staticFiles) || staticFiles.length === 0) {
                continue;
            }
            staticFiles.forEach((file) => {
                const matches = globSync(file, { cwd: path.dirname(step.filePath), absolute: true });
                matches.forEach((filePath) => {
                    const relativeFilePath = path.relative(builder.projectDir, filePath);
                    const content = fs.readFileSync(filePath);
                    archive.append(content, relativeFilePath);
                });
            });
        }
    }
};
